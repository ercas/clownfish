<!DOCTYPE html>
<html>
    <head>
        <meta charset=utf-8>
        <title>Clownfish - Upload a File</title>
        <link rel=stylesheet href=style.css>
    </head>
    <body>
        <h1>Clownfish</h1>
        <span class=description>a universal file conversion service</span>
        <br>
        <br><form action=confirm.php method=post enctype=multipart/form-data>
            <div id=file-label-container>
                <label id=file-label for=file class=label-blue>Choose File</label>
            </div>
            <div id=submit-label-container style="display: none;" >
                <label id=submit-label for=submit class=label-green>Upload</label>
            </div>
            <input id=file name=file type=file class=labeled-input>
            <input id=submit name=submit type=submit class=labeled-input>
        </form>
        <div id=footer>
            <a href=https://github.com/ercas/clownfish><img src=GitHub-Mark-32px.png></a>
        </div>

        <script>
            var file = document.getElementById("file");
            var oldFile = "none";
            var uploading = false;

            document.getElementById("submit-label").onclick = function() {
                var submitLabel = document.getElementById("submit-label");
                uploading = true;
                document.getElementById("file-label-container").setAttribute("style","display: none;");
                submitLabel.innerHTML = "Uploading " + oldFile + "...";
                submitLabel.setAttribute("class","label-grey");
            }

            function update() {
                if (oldFile != file.value && file.value != "") {
                    document.getElementById("file-label").innerHTML = file.value;
                    document.getElementById("submit-label-container").removeAttribute("style");
                    oldFile = file.value;
                }
                if (!uploading)
                    setTimeout(update, 500);
            }
            update();
        </script>
    </body>
</html>
